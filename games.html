<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="games.css">
  <title>Games</title>
</head>
<body>
    

  <!-- Empty div where navbar will be inserted -->
  <div id="header">
    <div class="container">

         <div class="header-text">
           <h1><span>O</span>wen.<br></h1>
       </div>  
             <nav>
                <div>
                <ul class="navbar">
                    <li><a href="index.html1.0gamesintegration.html" class="active">Home</a></li>
                    <li><a href="index.html1.0gamesintegration.html">About</a></li>
                    <li><a href="index.html1.0gamesintegration.html">My Interests</a></li>
                    <li><a href="index.html1.0gamesintegration.html">Portfolio</a></li>
                    <li><a href="index.html1.0gamesintegration.html">Contact</a></li>
                    <li><a href="#games">Games</a></li>
                </ul>
                </div>
            </nav>
            <div class="header-text-game">
                <h1>The Click Speed Test</h1>
            </div>
            <div class="header-text-description-game">
                <h1>In this game you goal is to click the mouse as many times as you can in 15 seconds.<br>After the game is over your score will be recorded and tallied onto the leaderboard. </h1>
            </div>
            <div>
                <p id="timer">Time Left: 15s</p>
                <button id="clickButton">Click Me!</button>
                <p id="score">Score: 0</p>
                <button id="restartButton" style="display: none;">Restart</button>
                <button id="resetLeaderboard">Reset Leaderboard</button>

                    <div class="score-bar-container">
                        <div id="scoreBar" class="score-bar"></div>
                    </div>
                    <div id="scoreboard">
                        <h2>Top 10 Scores</h2>
                        <ul id="scoreList"></ul>
                      </div>
            </div>
        </div>
    </div>
  
  <p></p>

  <script>
    // Fetch navbar.html and insert it into the div with id "navbar"
    fetch('navbar.html')
      .then(response => response.text())
      .then(data => document.getElementById('navbar').innerHTML = data);
  </script>

 <h2>Click Speed Test</h2>



   
   <p>
   
   </p>

   
   
   <img src="" border="2">
  


   <script>

    var tablinks = document.getElementsByClassName("tab-links");
    var tabcontents = document.getElementsByClassName("tab-contents");
  
    function opentab(tabname){
      for(tablink of tablinks){
        tablink.classList.remove("active-link");
      }
      for(tabcontent of tabcontents){
        tabcontent.classList.remove("active-tab");
      }
      event.currentTarget.classList.add("active-link");
      document.getElementById(tabname).classList.add("active-tab");
    }
  </script>
  
  <script>
  
  const API_BASE_URL = 'https://script.google.com/macros/s/AKfycbwTzLMiy8zlxpGU3b5kTBiN-gQjmR8sanSmZZvyalj0lj5WIGgwN52iuWYIJrSlsM5KRQ/exec'; // Replace with your deployed Google Apps Script URL

// Elements
const restartButton = document.getElementById('restartButton');
const timerDisplay = document.getElementById('timer');
const scoreDisplay = document.getElementById('score');
const scoreBar = document.getElementById('scoreBar');
const scoreList = document.getElementById('scoreList');
const resetLeaderboardButton = document.getElementById('resetLeaderboard');

let score = 0;
let timeLeft = 15; // Game duration in seconds
let timerId;

// Start the game
function startGame() {
  score = 0;
  timeLeft = 15; // Reset timer
  timerDisplay.textContent = `Time Left: ${timeLeft}s`;
  scoreDisplay.textContent = `Score: ${score}`;
  restartButton.style.display = 'none';
  scoreBar.style.width = '0%'; // Reset score bar

  // Start the timer
  timerId = setInterval(() => {
    timeLeft--;
    timerDisplay.textContent = `Time Left: ${timeLeft}s`;

    if (timeLeft <= 0) {
      endGame();
    }
  }, 1000);

  // Enable click tracking
  document.body.addEventListener('click', incrementScore);
}

// Handle clicks to increment the score
function incrementScore() {
  score++;
  scoreDisplay.textContent = `Score: ${score}`;
  updateScoreBar();
}

// Update the score bar based on the current score
function updateScoreBar() {
  const maxScore = 100; // Adjust based on expected max score
  const widthPercentage = Math.min((score / maxScore) * 100, 100); // Cap at 100%
  scoreBar.style.width = `${widthPercentage}%`;
}

// End the game
function endGame() {
  clearInterval(timerId);
  document.body.removeEventListener('click', incrementScore);
  restartButton.style.display = 'block';
  timerDisplay.textContent = `Time's Up!`;

  // Save the score
  saveScore(score);
}

// Save the player's score to the global leaderboard
async function saveScore(score) {
  let playerName = prompt('Enter your name:');

  // If the player cancels or leaves the name empty, don't save the score
  if (playerName === null || playerName.trim() === '') {
    alert("Score not saved.");
    return;
  }

  try {
    await fetch(API_BASE_URL, {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ action: 'save', name: playerName, score }),
    });
    alert("Score saved!");
    updateLeaderboard();
  } catch (error) {
    console.error('Error saving score:', error);
    alert("Failed to save score. Please try again.");
  }
}

// Fetch and display the leaderboard
async function updateLeaderboard() {
  try {
    const response = await fetch(API_BASE_URL);
    const leaderboard = await response.json();

    // Clear the existing leaderboard and populate with updated scores
    scoreList.innerHTML = '';
    leaderboard.forEach(({ name, score }, index) => {
      const listItem = document.createElement('li');
      listItem.textContent = `${index + 1}. ${name} - ${score}`;
      scoreList.appendChild(listItem);
    });
  } catch (error) {
    console.error('Error fetching leaderboard:', error);
    alert("Failed to load leaderboard. Please try again.");
  }
}

// Reset the leaderboard (admin-only)
async function resetLeaderboard() {
  const adminKey = prompt("Enter the admin password:");

  if (!adminKey) {
    alert("Password is required to reset the leaderboard.");
    return;
  }

  try {
    const response = await fetch(API_BASE_URL, {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ action: 'reset', adminKey }),
    });

    const result = await response.text();

    if (result === "Leaderboard reset") {
      alert(result);
      updateLeaderboard();
    } else {
      alert(result); // Show "Unauthorized" or other error messages
    }
  } catch (error) {
    console.error('Error resetting leaderboard:', error);
    alert("Failed to reset leaderboard. Please try again.");
  }
}

// Restart the game
restartButton.addEventListener('click', startGame);

// Admin-only reset leaderboard button
resetLeaderboardButton.addEventListener('click', resetLeaderboard);

// Initialize the leaderboard on page load
updateLeaderboard();

</script>



</body>
</html>
